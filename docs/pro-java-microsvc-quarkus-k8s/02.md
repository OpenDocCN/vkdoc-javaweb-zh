# 2.单片架构简介

## 对实际情况的介绍

如今，我们使用许多方法来访问在线应用程序。例如，我们可以使用浏览器或客户端应用程序访问脸书或推特。这可以通过它们公开的应用程序编程接口(API)来实现。API 是一个软件边界，它允许两个应用程序使用特定的协议(例如 HTTP)相互通信。在脸书环境中，当人们使用移动应用程序发送消息时，应用程序使用脸书 API 发出请求。接下来，应用程序使用其业务逻辑，进行所有必要的数据库查询，并通过返回 HTTP 响应来完成请求。

我们的主要竞争对手亚马逊、易贝和全球速卖通就是这种情况。![../images/509649_1_En_2_Chapter/509649_1_En_2_Figa_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figa_HTML.gif)是的！您将在本书中使用您的 Java 技能来开发一个电子商务应用程序，这将打败他们所有人！![../images/509649_1_En_2_Chapter/509649_1_En_2_Figb_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figb_HTML.gif)

![../images/509649_1_En_2_Chapter/509649_1_En_2_Figc_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figc_HTML.gif)是的！这本书涵盖了一个网上商店用例。![../images/509649_1_En_2_Chapter/509649_1_En_2_Figd_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figd_HTML.gif)

这个电子商务应用程序将有许多组件来管理客户，订单，产品，评论，购物车，认证等。

我们正在为不同的团队招募许多开发人员。每个团队都将致力于一个特定的业务领域，每个业务领域都将有其专用的代码。我们有一个架构师，他将负责打包和构建应用程序。

Java 应用程序将被部署为一个巨大的`WAR`文件，该文件包装了来自不同团队的所有代码以及项目的所有外部依赖项，比如框架和库。为了将这个应用程序交付给生产团队，项目经理必须确保所有的软件团队按时交付他们的代码。如果其中一个团队因为任何原因延迟，应用程序肯定会延迟，因为它不能交付未完成的部分。

→如何解决这个问题？![../images/509649_1_En_2_Chapter/509649_1_En_2_Fige_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Fige_HTML.gif)

我们还听说了敏捷性。我们的项目可以采用敏捷吗？我们能从敏捷过程中获益吗？

→如何解决这个问题？![../images/509649_1_En_2_Chapter/509649_1_En_2_Figf_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figf_HTML.gif)

我们知道，在很多时候，我们的电子商务网站会受到顾客的狂轰滥炸，比如黑色星期五、圣诞节前几天、情人节等。我们要求我们的生产团队为此应用程序提供高可用性。解决方案是让应用程序有许多正在运行的实例，以确保它能够处理负载。但是这个解决方案是最好的吗？我们当前的架构在高可用性方面有优势吗？

→如何解决这个问题？![../images/509649_1_En_2_Chapter/509649_1_En_2_Figg_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figg_HTML.gif)

## 介绍背景

该应用程序的实际架构是*单片*，这意味着它由一个应用程序组成，该应用程序:

*   **设计简单**:我们可以轻松地设计和重构组件，因为我们对整个生态系统有一个全面的了解。

*   **开发简单**:当前开发工具和 ide 的目标是支持单片应用程序的开发。

*   **简单部署**:我们需要将`WAR`文件(或目录层次结构)部署到适当的运行时。

*   **易于扩展**:我们可以通过在负载平衡器后运行应用程序的多个副本来扩展应用程序。

然而，一旦应用程序变得很大，团队的规模也变大了，这种方法就有了许多越来越明显的缺点:

*   日益增加的复杂性:一个庞大的整体代码库让开发人员感到害怕，尤其是新开发人员。源代码可能难以阅读/理解和重构。因此，开发通常会变慢。很难理解如何正确地实现变更，这会降低代码的质量。

*   **过载的开发机器**:大型应用程序会导致开发机器负载过重，从而降低生产率。

*   **过载的服务器**:大型应用程序很难监控，需要大量的服务器资源，这会影响工作效率。

*   连续部署很困难:大型的、单一的应用程序也很难部署，因为它需要从事不同服务的团队之间强有力的同步。此外，要更新一个组件，您必须重新部署整个应用程序。与重新部署相关的风险增加了，这阻碍了频繁的更新。这对于用户界面开发人员来说尤其成问题，因为他们通常需要快速迭代和频繁重新部署。

*   **扩展应用程序可能很困难**:整体架构只能在一个维度上扩展:仅仅通过创建整体的副本。应用程序实例的每个副本都将访问所有数据，这使得缓存效率降低，并增加了内存消耗和 I/O 流量。此外，不同的应用程序组件有不同的资源需求。一个可能是 CPU 密集型，另一个可能是内存密集型。对于整体架构，我们无法独立扩展每个组件。

*   **规模化发展的障碍**:单体应用也是规模化发展的障碍。一旦应用程序达到一定的规模，将工程组织分成专注于特定功能领域的团队是很有用的。单一应用程序的问题在于它阻止了团队独立工作。团队必须协调他们的开发和部署工作。对于一个团队来说，做出改变和更新产品要困难得多。

## 解决这些问题

为了解决这些问题，我们将讨论*微服务*:这本书的主题，也是当今最时髦的词汇之一，因为我正在写这本书。这是我们在接下来的几章中要讨论的内容。敬请关注！![../images/509649_1_En_2_Chapter/509649_1_En_2_Figh_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figh_HTML.gif)

祝你阅读愉快。祝你好运！![../images/509649_1_En_2_Chapter/509649_1_En_2_Figj_HTML.gif](../images/509649_1_En_2_Chapter/509649_1_En_2_Figj_HTML.gif)